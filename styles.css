/* ——— Mistyczny motyw, mobile-first ——— */
*{box-sizing:border-box}
:root{--header-h:56px}
:root{
  --bg:#0b0a12; --panel:rgba(20,18,30,.6); --muted:#aab0c0; --text:#eceaf7;
  --accent:#b793ff; --accent-2:#3ddc97; --danger:#ff6b6b;
  --card:rgba(26,24,38,.6); --ring:0 0 0 3px rgba(214,188,250,.35); --gold:#e2c17d
}
[data-theme="light"]{
  --bg:#f7f5ff; --panel:rgba(255,255,255,.65); --muted:#5b6070; --text:#1a1531;
  --accent:#7c3aed; --accent-2:#16a34a; --danger:#dc2626;
  --card:rgba(255,255,255,.8); --ring:0 0 0 3px rgba(124,58,237,.25); --gold:#b0892f
}
:root{ color-scheme: light dark; }

html,body{height:100%}
body{
  margin:0; font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Noto Sans,sans-serif;
  color:var(--text); display:grid; grid-template-rows:auto auto 1fr; gap:10px;
  background:var(--bg); padding-top:env(safe-area-inset-top);
  background-image:
    radial-gradient(1200px 600px at 10% -10%, rgba(151,71,255,.25), transparent 60%),
    radial-gradient(1000px 500px at 90% 10%, rgba(255,183,77,.18), transparent 60%),
    radial-gradient(800px 400px at 50% 120%, rgba(56,189,248,.15), transparent 60%),
    radial-gradient(2px 2px at 20% 30%, rgba(255,255,255,.8), transparent 70%),
    radial-gradient(2px 2px at 40% 70%, rgba(255,255,255,.6), transparent 70%),
    radial-gradient(1.5px 1.5px at 70% 40%, rgba(255,255,255,.7), transparent 70%);
}
h1,h2,h3,h4{font-family:Cinzel,Georgia,serif;letter-spacing:.3px}

.app-header{
  display:flex;align-items:center;justify-content:space-between;
  padding:calc(8px + env(safe-area-inset-top)) 12px 8px;
  background:var(--panel); backdrop-filter:blur(12px);
  border-bottom:1px solid rgba(255,255,255,.08);
  position:sticky;top:0;z-index:50; box-shadow:0 10px 30px rgba(0,0,0,.25)
}
.app-header .left{display:flex;align-items:center;gap:10px}
.app-header h1{margin:0;font-size:clamp(18px,4vw,28px)}
.actions{display:flex;gap:8px;align-items:center}

.icon-btn{display:inline-flex;align-items:center;justify-content:center;width:36px;height:36px;border-radius:10px;border:1px solid rgba(255,255,255,.12);background:linear-gradient(180deg,rgba(255,255,255,.1),rgba(0,0,0,.1));color:var(--text);cursor:pointer}
.icon-btn:focus{outline:none;box-shadow:var(--ring)}
.btn{appearance:none;border:1px solid rgba(255,255,255,.12);background:linear-gradient(180deg,rgba(255,255,255,.1),rgba(0,0,0,.1));color:var(--text);padding:8px 12px;border-radius:999px;cursor:pointer;font-weight:600;box-shadow:inset 0 1px 0 rgba(255,255,255,.08),0 6px 18px rgba(0,0,0,.2)}
.btn:hover{border-color:rgba(255,255,255,.25);filter:brightness(1.05)}
.btn.primary{background:linear-gradient(180deg,var(--accent),#6d49d7);border-color:transparent;color:#0b0a12}
.btn.success{background:linear-gradient(180deg,var(--accent-2),#1e9f6d);border-color:transparent;color:#0b0a12}
.btn.danger{background:linear-gradient(180deg,var(--danger),#d83c3c);border-color:transparent;color:#fff}
.btn.small{padding:6px 10px;font-size:13px}

/* Tabs – desktop/tablet. Na telefonie ukrywamy i używamy hamburgera */
.tabs{display:none;gap:8px;padding:0 12px 6px;overflow:auto;position:sticky;top:calc(env(safe-area-inset-top) + var(--header-h));z-index:30}
.tabs button{background:var(--panel);color:var(--text);border:1px solid rgba(255,255,255,.1);padding:10px 14px;border-radius:999px;cursor:pointer;white-space:nowrap}
.tabs button.active{outline:var(--ring);border-color:transparent;background:linear-gradient(0deg,rgba(183,147,255,.25),rgba(183,147,255,.25)),var(--panel)}
@media (min-width:720px){.tabs{display:flex}#openMenu{display:none}}

main{padding:0 12px 28px}
.panel{background:var(--panel);border:1px solid rgba(255,255,255,.08);border-radius:18px;padding:14px;backdrop-filter:blur(16px);box-shadow:0 20px 60px rgba(0,0,0,.25), inset 0 1px 0 rgba(255,255,255,.06);width:100%}

.grid{display:grid;gap:14px}
.grid>*{min-width:0}
.grid.two{grid-template-columns:1fr}
@media (min-width:920px){.grid.two{grid-template-columns:368px 1fr}}

.field{display:grid;gap:6px;margin-bottom:12px}
.field.inline{grid-template-columns:140px 1fr;align-items:center}
.field label{font-weight:600;color:var(--muted);font-size:13px}

input[type="text"],input[type="date"],input[type="url"],input[type="search"],textarea,select{
  background:var(--card); border:1px solid rgba(255,255,255,.12); color:var(--text);
  padding:10px 12px; border-radius:12px; outline:none; width:100%;
  -webkit-appearance:none; appearance:none; background-clip:padding-box;
  font-size:16px; /* anti-zoom iOS */
}
input:focus,textarea:focus,select:focus{box-shadow:var(--ring);border-color:transparent}
textarea{min-height:100px;resize:vertical}

.cards-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(170px,1fr));gap:12px}
.card{background:var(--card);border:1px solid rgba(255,255,255,.12);border-radius:18px;overflow:hidden;display:flex;flex-direction:column;box-shadow:0 12px 36px rgba(0,0,0,.25)}
.card img{width:100%;aspect-ratio:3/5;object-fit:cover;background:#0b0d12;border-bottom:1px solid rgba(255,255,255,.08)}
.card .meta{padding:12px;display:grid;gap:10px}
.card .meta h4{margin:0;font-size:16px;font-family:Cinzel,Georgia,serif}

.row{display:flex;gap:8px;align-items:center}
.row.wrap{flex-wrap:wrap}
.row>*{min-width:0}
.spacer{flex:1}
.muted{color:var(--muted)}
.toolbar{display:flex;gap:8px;align-items:center;margin-bottom:12px}

.dropzone{border:1.5px dashed rgba(255,255,255,.22);background:rgba(0,0,0,.15);padding:14px;border-radius:12px;text-align:center;cursor:pointer;transition:.2s}
.dropzone.dragover{border-color:var(--accent);background:rgba(139,92,246,.12)}

.list{display:grid;gap:10px}
.entry{display:grid;grid-template-columns:64px 1fr;gap:12px;background:var(--card);border:1px solid rgba(255,255,255,.12);border-radius:16px;padding:10px;align-items:center;box-shadow:0 10px 30px rgba(0,0,0,.25)}
.entry img{width:64px;height:96px;object-fit:cover;border-radius:10px;background:#0b0d12}
.entry .title{font-weight:800;font-family:Cinzel,Georgia,serif}
.entry .date{color:var(--muted);font-size:12px}

.kpi{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:12px;margin:12px 0}
.kpi .box{background:var(--card);border:1px solid rgba(255,255,255,.12);padding:12px;border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,.25)}
.bar{height:10px;background:rgba(255,255,255,.12);border-radius:999px;overflow:hidden}
.bar>div{height:100%;background:linear-gradient(90deg,var(--accent),var(--gold))}

.chips{display:flex;flex-wrap:wrap;gap:6px}
.chip{display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border-radius:999px;background:rgba(183,147,255,.18);border:1px solid rgba(183,147,255,.35);font-weight:600}
.chip button{border:none;background:transparent;color:inherit;cursor:pointer;padding:0 2px}
.suggestions{display:flex;flex-wrap:wrap;gap:6px;margin-top:6px}
.suggestions .suggest{padding:6px 10px;border-radius:999px;border:1px dashed rgba(255,255,255,.25);cursor:pointer}
.suggestions .suggest:hover{border-style:solid}

.preview{align-items:flex-start;gap:14px}
#dailyPreviewImg{width:120px;height:200px;object-fit:cover;border-radius:12px;background:#0b0d12;box-shadow:0 10px 30px rgba(0,0,0,.35)}
.help{line-height:1.6}
.hint{font-size:12px;color:var(--muted)}

/* Dialog: bez białego tła/ramki, dopasowanie */
dialog{border:none;padding:0;background:transparent}
dialog::backdrop{background:rgba(0,0,0,.55)}
.modal{background:var(--panel);color:var(--text);min-width:min(94vw,920px);max-width:94vw;border-radius:18px;overflow:hidden}
.modal-header{position:sticky;top:0;background:var(--panel);padding:12px 16px;border-bottom:1px solid rgba(255,255,255,.12);backdrop-filter:blur(8px);z-index:1}
.modal-body{padding:16px;max-height:70vh;overflow:auto}

/* Hamburger menu – kafelki */
#navDialog .modal{width:min(94vw,520px)}
#navDialog .menu-list{display:grid;gap:12px}
#navDialog .menu-item{
  display:flex;align-items:center;gap:12px;font-size:18px;letter-spacing:.3px;color:var(--text);
  background:linear-gradient(180deg,rgba(255,255,255,.04),rgba(0,0,0,.06)),var(--card);
  border:1px solid rgba(255,255,255,.14);border-radius:14px;padding:14px;
  box-shadow:0 10px 24px rgba(0,0,0,.25), inset 0 1px 0 rgba(255,255,255,.06)
}
#navDialog .menu-item::before{content:'✦';opacity:.9}
/* === V3.2.1 — unifikacja rozmiarów przycisków i kontrolek === */
:root{
  --btn-h:44px;       /* bazowy przycisk (mobile) */
  --btn-sm-h:36px;    /* mały przycisk */
  --btn-lg-h:48px;    /* duży przycisk (opcjonalnie) */
  --ctl-h:44px;       /* wysokość input/select/date/search */
  --btn-fs:14px;      /* bazowy font */
  --btn-sm-fs:13px;
  --btn-lg-fs:15px;
}

/* przycisk jako kapsułka z wyrównaniem pionowym */
.btn{
  display:inline-flex; align-items:center; justify-content:center;
  height:var(--btn-h); padding:0 14px; font-size:var(--btn-fs);
  border-radius:999px; line-height:1; white-space:nowrap;
}
.btn.small{ height:var(--btn-sm-h); padding:0 12px; font-size:var(--btn-sm-fs); }
.btn.large{ height:var(--btn-lg-h); padding:0 16px; font-size:var(--btn-lg-fs); }

/* warianty kolorystyczne NIE zmieniają wysokości */
.btn.primary, .btn.success, .btn.danger{ height:var(--btn-h); }

/* ujednolicone wysokości dla pól formularza */
input[type="text"], input[type="date"], input[type="url"],
input[type="search"], select{
  height:var(--ctl-h);
  display:inline-flex; align-items:center; /* iOS: ładne wyrównanie tekstu */
}

/* wiersze z przyciskami i polami — ładne łamanie, równa przerwa */
.row{ gap:10px; }
.row.wrap > *{ flex:0 1 auto; }

/* trochę ciaśniej w kartach, żeby „Edytuj/Usuń” nie były zbyt wielkie */
.cards-grid .btn.small{ height:34px; padding:0 10px; font-size:13px; }

/* desktop: nieco mniejsze, ale spójne */
@media (min-width: 720px){
  :root{
    --btn-h:40px; --btn-sm-h:34px; --btn-lg-h:44px;
    --ctl-h:40px; --btn-fs:14px; --btn-sm-fs:13px; --btn-lg-fs:15px;
  }
}
/* Ikona nastroju (zamiast pustego obrazka) */
.mood-icon{
  width:64px; height:64px;
  display:flex; align-items:center; justify-content:center;
  border-radius:12px;
  background: linear-gradient(180deg, rgba(183,147,255,.20), rgba(255,214,165,.18)), var(--card);
  border:1px solid rgba(255,255,255,.14);
  box-shadow:0 10px 24px rgba(0,0,0,.25), inset 0 1px 0 rgba(255,255,255,.06);
  font-size:28px; font-weight:800;
}
/* ==== FIX: ucinanie daty w pasku filtrów (iOS Safari) ==== */
/* Wróć do normalnego boxa + daj minimalną szerokość na polski format „31 gru 2025” */
.toolbar input[type="date"]{
  display: inline-block;      /* zamiast inline-flex */
  min-width: 12.5ch;          /* mieści „31 gru 2025” z luzem */
  text-align: center;         /* ładne wyśrodkowanie */
  padding-inline: 12px;       /* oddech po bokach */
}

/* Gdy mało miejsca – pozwól łamać całość na dwie linie */
.toolbar label.muted{ flex-wrap: wrap; }
.toolbar label.muted input[type="date"]{ flex: 0 0 auto; }

/* iOS drobiazgi – czytelniejsze cyfry (opcjonalne) */
@supports (-webkit-touch-callout: none) {
  .toolbar input[type="date"]{
    font-variant-numeric: tabular-nums;
    letter-spacing: .2px;
  }
}
/* ==== FIX: Podgląd w "Dzienne notatki" nie ściska obrazka ==== */
.preview{
  display:flex; flex-wrap:wrap; gap:14px; align-items:flex-start;
}

/* obrazek – nie pozwalamy mu się kurczyć */
#dailyPreviewImg{
  flex:0 0 120px; /* stałe 120px obok tekstu */
  width:120px; height:200px; object-fit:cover;
}

/* prawa kolumna: może się zwężać, a gdy brakuje miejsca – wskakuje pod obrazek */
.preview > div{
  min-width:0;            /* ważne na iOS, żeby treść mogła się zawijać */
  flex:1 1 240px;         /* docelowo obok obrazka */
}
@media (max-width: 480px){
  .preview > div{ flex-basis:100%; } /* na wąskich ekranach całość pod obrazkiem */
}

/* chipy niech ładnie się łamią i nie wypychają układu */
#dailyPreviewMoods{ display:flex; flex-wrap:wrap; gap:6px; }
